<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width">
<meta name="description" content="fBM with wasm">
<title>Wasm fBM</title>
</head>
<body>
  <div>
    <input type="range" id="hurst" name="hurst" min="1" max="100" />
    <label for="hurst">Hurst</label>
  </div>
  <div>
    <input type="range" id="octaves" name="octaves" min="1" max="24" />
    <label for="octaves">Octaves</label>
  </div>
  <div>
    <input type="range" id="scale" name="scale" min="1" max="10" />
    <label for="scale">Scale</label>
  </div>
  <div>
    <canvas id="canvas" width="1280" height="960">
  </div>
  <script type="module">
    import { draw_fbm } from "./js/fbm.mjs";

    let scale = 0.005;
    let H = 0.5;
    let num_octaves = 12;
    let x = 1;
    let y = 1;

    const hurst_slider = document.getElementById('hurst');
    hurst_slider.addEventListener("input", (event) => {
      H = event.target.value / 100;
      draw_fbm(canvas, scale, num_octaves, H, x, y);
    });

    const octaves_slider = document.getElementById('octaves');
    octaves_slider.addEventListener("input", (event) => {
      num_octaves = event.target.value;
      draw_fbm(canvas, scale, num_octaves, H, x, y);
    });

    const scale_slider = document.getElementById('scale');
    scale_slider.addEventListener("input", (event) => {
      scale = event.target.value / 1000;
      draw_fbm(canvas, scale, num_octaves, H, x, y);
    });

    const canvas = document.getElementById('canvas');
    canvas.addEventListener("mousedown", (e) => {
      if (e.button == 0) {
        const dx = e.offsetX * scale - x;
        const dy = e.offsetY * scale - y;
        x += dx;
        y += dy;
        draw_fbm(canvas, scale, num_octaves, H, x, y);
      }
    });

    draw_fbm(canvas, scale, num_octaves, H, x, y);
  </script>
</body>
